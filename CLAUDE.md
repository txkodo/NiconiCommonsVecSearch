# 開発フロー

## 標準的な開発手順

1. **mainブランチを最新に更新**
   ```bash
   git checkout main
   git pull origin main
   ```

2. **新しいブランチを作成**
   ```bash
   git checkout -b feature/issue-{issue番号}
   ```

3. **設計・実装方針の決定**
   - issueの内容を詳しく分析
   - 実装する機能の設計を検討
   - 技術選択・アーキテクチャを決定
   - **必ずユーザーに設計・方針を確認してから実装開始**

4. **段階的な開発作業**
   - 小さな単位で機能を実装
   - 各段階でコミットを作成（手戻りを最小化）
   - テストの実行
   - リントチェック

5. **変更をコミット**
   ```bash
   git add .
   git commit -m "適切なコミットメッセージ"
   ```

6. **ブランチをプッシュ**
   ```bash
   git push -u origin feature/issue-{issue番号}
   ```

7. **プルリクエストを作成**
   ```bash
   gh pr create --title "タイトル" --body "説明

   Closes #{issue番号}"
   ```
   - PR本文に `Closes #{issue番号}` を記載すると、マージ時に自動でissueが閉じられる
   - 他のキーワード: `Fixes`, `Resolves`, `Closes`

## 設計・実装フロー

### 1. 要件分析
- issueの内容を詳細に分析
- 実装すべき機能・要件を明確化
- 制約条件・前提条件の確認

### 2. 設計検討
- システム構成・アーキテクチャの検討
- 技術スタックの選定
- ファイル構成・ディレクトリ構造の決定
- 外部サービス・APIの選定

### 3. 実装方針の決定
- 実装順序・段階の計画
- コミット分割の方針
- テスト戦略
- **ユーザー確認**: 設計・方針をユーザーに提示し、承認を得る

### 4. 段階的実装
- 小さな単位での実装
- 各段階でのコミット
- 動作確認・テスト
- 問題があれば早期に修正

## プロジェクト固有の情報

### ディレクトリ構成
- `frontend/` - Svelte 5フロントエンド
- `backend/` - Pythonバックエンド  
- `tools/` - 開発者用ツール
- `.github/` - GitHub設定・ワークフロー
- `infrastructure/` - IaC・デプロイ設定

### 技術スタック
- バックエンド: Python, CLAP, Qdrant
- フロントエンド: Svelte 5
- CI/CD: GitHub Actions
- インフラ: IaC (Terraform推奨)

### 開発時の注意点
- 楽曲の再配信は規約違反のため、ニコニ・コモンズへのリンクのみ提供
- CLAP による音楽ベクトル化処理はリソース集約的
- Qdrant データベースへの接続設定が必要
- **実装前に必ず設計・方針をユーザーに確認**
- 適切なコミット分割で手戻りを最小化